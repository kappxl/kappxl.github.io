"use strict";(self["webpackChunkfoodbase_app"]=self["webpackChunkfoodbase_app"]||[]).push([[916],{8500:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Be});var a=o(3673);const l=(0,a.Uk)("Ingredients (day)"),i=(0,a.Uk)("Ingredients (plan)"),n=(0,a.Uk)("Copy current day"),d=(0,a.Uk)("Paste day"),s=(0,a.Uk)("Meal"),c=(0,a.Uk)("Ingredient"),r={class:"flex flex-center"},p={class:"col",style:{"max-width":"650px"}};function u(e,t,o,u,m,y){const f=(0,a.up)("fb-toggle"),g=(0,a.up)("q-icon"),h=(0,a.up)("q-item-section"),D=(0,a.up)("q-item"),w=(0,a.up)("q-separator"),_=(0,a.up)("q-list"),k=(0,a.up)("q-menu"),q=(0,a.up)("q-btn"),W=(0,a.up)("fb-header"),Z=(0,a.up)("Diary"),v=(0,a.up)("Plan"),S=(0,a.up)("ShoppingList"),b=(0,a.up)("q-spinner-tail"),C=(0,a.up)("q-inner-loading"),F=(0,a.up)("fb-layout");return(0,a.wg)(),(0,a.j4)(F,null,{header:(0,a.w5)((()=>[(0,a.Wm)(W,{title:"Foodbase"},{left:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:e.planTypeModel,"onUpdate:modelValue":t[0]||(t[0]=t=>e.planTypeModel=t),label:e.planType,"left-label":""},null,8,["modelValue","label"])])),right:(0,a.w5)((()=>[(0,a.Wm)(q,{round:"",flat:"",icon:"more_vert",class:"q-mr-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{"transition-show":"jump-down","transition-hide":"jump-up"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{style:{"min-width":"200px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{clickable:"",onClick:t[1]||(t[1]=t=>e.openShoppingList("day"))},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{color:"accent",name:"shopping_bag"})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[l])),_:1})])),_:1}),(0,a.Wm)(D,{clickable:"",onClick:t[2]||(t[2]=t=>e.openShoppingList("plan"))},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{color:"accent",name:"shopping_cart"})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[i])),_:1})])),_:1}),(0,a.Wm)(w),(0,a.Wm)(D,{clickable:"",onClick:e.copyPlan},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{color:"accent",name:"content_copy"})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[n])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(D,{clickable:"",onClick:e.pastePlan},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{color:"accent",name:"content_paste"})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[d])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(w),(0,a.Wm)(D,{clickable:"",onClick:t[3]||(t[3]=t=>e.$router.push({name:"food",params:{tabProp:"Meals"}}))},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{color:"accent",name:"add"})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[s])),_:1})])),_:1}),(0,a.Wm)(D,{clickable:"",onClick:t[4]||(t[4]=t=>e.$router.push({name:"food",params:{tabProp:"Ingredients"}}))},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{color:"accent",name:"add"})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[c])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a._)("div",p,["Diary"===e.planType?((0,a.wg)(),(0,a.j4)(Z,{key:0,ref:"Diary"},null,512)):"Plan"===e.planType?((0,a.wg)(),(0,a.j4)(v,{key:1,ref:"Plan"},null,512)):(0,a.kq)("",!0)])]),(0,a.Wm)(S,{list:e.list,ref:"shoppingList"},null,8,["list"]),(0,a.Wm)(C,{showing:e.loading},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{size:"100px",color:"primary"})])),_:1},8,["showing"])])),_:1})}o(9544),o(71);var m=o(1959);const y={class:"q-pt-lg column flex flex-center"},f={class:"full-width"},g={class:"q-pa-lg"};function h(e,t,o,l,i,n){const d=(0,a.up)("SelectDate"),s=(0,a.up)("NutriDisplay"),c=(0,a.up)("MacroFoodList"),r=(0,a.up)("q-btn"),p=(0,a.up)("DetailsDialog"),u=(0,a.up)("q-spinner-tail"),m=(0,a.up)("q-inner-loading");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",y,[(0,a._)("div",f,[(0,a.Wm)(d,{onChanged:e.updateFoodlist},null,8,["onChanged"]),(0,a.Wm)(s,{food:e.food},null,8,["food"]),(0,a.Wm)(c,{quantity:"",food:e.food,onSelected:e.showDetails,onAdd:t[0]||(t[0]=t=>e.$router.push({name:"food"}))},null,8,["food","onSelected"])]),(0,a._)("div",g,[(0,a.Wm)(r,{size:"lg",round:"",color:"accent",icon:"add","text-color":"primary",onClick:t[1]||(t[1]=t=>e.$router.push({name:"food"}))})])]),(0,a.Wm)(p,{noconfirm:"",ref:"foodDetails",food:e.selectedFood,onDelete:e.removeFood},null,8,["food","onDelete"]),(0,a.Wm)(m,{showing:e.loading},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{size:"100px",color:"primary"})])),_:1},8,["showing"])])}var D=o(2323);const w={class:"row justify-center items-center q-pb-md"},_={class:"q-px-md col-auto"},k={class:"q-px-md col-auto"};function q(e,t,o,l,i,n){const d=(0,a.up)("q-btn"),s=(0,a.up)("q-date"),c=(0,a.up)("q-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",w,[(0,a._)("div",_,[(0,a.Wm)(d,{round:"",flat:"",size:"md",color:"accent",icon:"arrow_back_ios_new",onClick:e.selectDayBefore},null,8,["onClick"])]),(0,a._)("h3",{class:"text-center text-accent text-ios col row justify-center items-center",onClick:t[0]||(t[0]=t=>e.datePickerDialog=!e.datePickerDialog)},(0,D.zw)(null!==e.date?`${e.date.split("/")[2]}.${e.date.split("/")[1]}.${e.date.split("/")[0]}`:"No date"),1),(0,a._)("div",k,[(0,a.Wm)(d,{round:"",flat:"",size:"md",color:"accent",icon:"arrow_forward_ios",onClick:e.selectDayAfter},null,8,["onClick"])])]),(0,a.Wm)(c,{modelValue:e.datePickerDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.datePickerDialog=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{modelValue:e.date,"onUpdate:modelValue":t[1]||(t[1]=t=>e.date=t),class:(0,D.C_)({"text-primary":!!e.$q.dark.isActive})},null,8,["modelValue","class"])])),_:1},8,["modelValue"])])}var W=o(7691),Z=o(1897),v=o.n(Z);const S=(0,a.aZ)({name:"SelectDate",setup(){return{datePickerDialog:(0,m.iH)(!1),date:(0,m.iH)(null)}},mounted(){this.date=(0,W.dateToQDate)(v().getSelectedDay())},methods:{selectDayBefore(){let e=new Date(this.date);e.setDate(e.getDate()-1),this.date=(0,W.dateToQDate)(e)},selectDayAfter(){let e=new Date(this.date);e.setDate(e.getDate()+1),this.date=(0,W.dateToQDate)(e)}},watch:{date(e){v().setSelectedDay(new Date(e)),this.datePickerDialog=!1,this.$emit("changed",new Date(e))}}});var b=o(4260),C=o(4607),F=o(5926),x=o(6915),Q=o(7518),T=o.n(Q);const L=(0,b.Z)(S,[["render",q],["__scopeId","data-v-25476534"]]),$=L;T()(S,"components",{QBtn:C.Z,QDialog:F.Z,QDate:x.Z});var P=o(952),H=o(7783),I=o(7136);const{getFoodFromDay:V,removeFoodFromDay:z}=o(2221),{getSelectedDay:U}=o(1897),{dayToStorageDate:M}=o(7691),j=(0,a.aZ)({name:"Diary",components:{SelectDate:$,NutriDisplay:P.Z,MacroFoodList:H.Z,DetailsDialog:I.Z},setup(){return{loading:(0,m.iH)(!1),food:(0,m.iH)([]),selectedFood:(0,m.iH)(null)}},mounted(){this.updateFoodlist()},methods:{removeFood(e){let t=M(U());z({storageDay:t,food:e}),this.updateFoodlist()},showDetails(e){this.selectedFood=e,this.$refs.foodDetails.open()},updateFoodlist(){let e=M(U());this.loading=!0,V({storageDay:e}).then((e=>{this.food=e})).finally((()=>this.loading=!1))}}});var B=o(6941),A=o(682);const N=(0,b.Z)(j,[["render",h]]),O=N;T()(j,"components",{QBtn:C.Z,QInnerLoading:B.Z,QSpinnerTail:A.Z});const K={class:"q-pt-lg column flex flex-center"},Y={class:"full-width"},R={class:"q-pa-lg"};function E(e,t,o,l,i,n){const d=(0,a.up)("SelectWeekday"),s=(0,a.up)("NutriDisplay"),c=(0,a.up)("MacroFoodList"),r=(0,a.up)("q-btn"),p=(0,a.up)("DetailsDialog"),u=(0,a.up)("q-spinner-tail"),m=(0,a.up)("q-inner-loading");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",K,[(0,a._)("div",Y,[(0,a.Wm)(d,{onChanged:e.updateFoodlist},null,8,["onChanged"]),(0,a.Wm)(s,{food:e.food},null,8,["food"]),(0,a.Wm)(c,{quantity:"",food:e.food,onSelected:e.showDetails,onAdd:t[0]||(t[0]=t=>e.$router.push({name:"food"}))},null,8,["food","onSelected"])]),(0,a._)("div",R,[(0,a.Wm)(r,{size:"lg",round:"",color:"accent",icon:"add","text-color":"primary",onClick:t[1]||(t[1]=t=>e.$router.push({name:"food"}))})])]),(0,a.Wm)(p,{noconfirm:"",ref:"foodDetails",food:e.selectedFood,onDelete:e.removeFood},null,8,["food","onDelete"]),(0,a.Wm)(m,{showing:e.loading},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{size:"100px",color:"primary"})])),_:1},8,["showing"])])}const G={id:"day",class:"row justify-center items-center q-pb-md"},J={class:"q-px-md col-auto"},X={class:"q-px-md col-auto"};function ee(e,t,o,l,i,n){const d=(0,a.up)("q-btn"),s=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),r=(0,a.up)("q-list"),p=(0,a.up)("q-card-section"),u=(0,a.up)("q-card"),m=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup"),f=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",G,[(0,a._)("div",J,[(0,a.Wm)(d,{round:"",flat:"",size:"md",color:"accent",icon:"arrow_back_ios_new",onClick:e.selectDayBefore},null,8,["onClick"])]),(0,a._)("h3",{class:"text-center text-accent pacifico col",onClick:t[0]||(t[0]=t=>e.selectDayDialog=!e.selectDayDialog)},(0,D.zw)(e.weekdays[e.day]),1),(0,a._)("div",X,[(0,a.Wm)(d,{round:"",flat:"",size:"md",color:"accent",icon:"arrow_forward_ios",onClick:e.selectDayAfter},null,8,["onClick"])])]),(0,a.Wm)(m,{modelValue:e.selectDayDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectDayDialog=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,{bordered:"",separator:"",style:{"min-width":"300px"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.weekdays,(t=>(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{class:(0,D.C_)({"text-primary":e.day===e.weekdays.indexOf(t),"bg-accent":e.day===e.weekdays.indexOf(t)}),clickable:"",key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{class:"text-center text-body1",onClick:o=>e.selectDay(t)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,D.zw)(t),1)])),_:2},1032,["onClick"])])),_:2},1032,["class"])),[[y],[f]]))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}const te=(0,a.aZ)({name:"SelectWeekday",setup(){return{selectDayDialog:(0,m.iH)(!1),day:(0,m.iH)(0),weekdays:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]}},mounted(){this.day=v().getSelectedDay()},methods:{selectDayBefore(){0===this.day?this.day=6:this.day=this.day-1,v().setSelectedDay(this.day)},selectDayAfter(){this.day=(this.day+1)%7,v().setSelectedDay(this.day)},selectDay(e){this.day=this.weekdays.indexOf(e),v().setSelectedDay(Math.max(0,this.day))}},watch:{day(){this.$emit("changed",this.day)}}});var oe=o(151),ae=o(5589),le=o(7011),ie=o(3414),ne=o(2035),de=o(677),se=o(6489);const ce=(0,b.Z)(te,[["render",ee],["__scopeId","data-v-9957f388"]]),re=ce;T()(te,"components",{QBtn:C.Z,QDialog:F.Z,QCard:oe.Z,QCardSection:ae.Z,QList:le.Z,QItem:ie.Z,QItemSection:ne.Z}),T()(te,"directives",{ClosePopup:de.Z,Ripple:se.Z});const{getFoodFromDay:pe,removeFoodFromDay:ue}=o(2221),{getSelectedDay:me}=o(1897),{dayToStorageDate:ye}=o(7691),fe=(0,a.aZ)({name:"Plan",components:{SelectWeekday:re,NutriDisplay:P.Z,MacroFoodList:H.Z,DetailsDialog:I.Z},setup(){return{loading:(0,m.iH)(!1),food:(0,m.iH)([]),selectedFood:(0,m.iH)({})}},mounted(){this.updateFoodlist()},methods:{removeFood(e){let t=ye(me());ue({storageDay:t,food:e}),this.updateFoodlist()},showDetails(e){this.selectedFood=e,this.$refs.foodDetails.open()},updateFoodlist(){let e=ye(me());this.loading=!0,pe({storageDay:e}).then((e=>{this.food=e})).finally((()=>this.loading=!1))}}}),ge=(0,b.Z)(fe,[["render",E]]),he=ge;T()(fe,"components",{QBtn:C.Z,QInnerLoading:B.Z,QSpinnerTail:A.Z});const De={class:"q-pa-md"},we={key:0},_e=["onClick"],ke={key:1},qe={class:"q-pa-lg row flex flex-center"},We=(0,a.Uk)(" No items added yet. ");function Ze(e,t,o,l,i,n){const d=(0,a.up)("q-checkbox"),s=(0,a.up)("q-icon"),c=(0,a.up)("q-separator"),r=(0,a.up)("fb-popup-dialog");return(0,a.wg)(),(0,a.j4)(r,{actions:"close",ref:"shoppingListDialog",title:"Shopping list"},{default:(0,a.w5)((()=>[(0,a._)("div",De,[e.foodList&&e.foodList.length>0?((0,a.wg)(),(0,a.iD)("div",we,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.foodList,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",{onClick:t=>e.ticked=!e.ticked},[(0,a.Wm)(d,{modelValue:e.ticked,"onUpdate:modelValue":t=>e.ticked=t,class:"q-mr-sm"},null,8,["modelValue","onUpdate:modelValue"]),(0,a._)("strong",null,(0,D.zw)(e.quantity?`${e.quantity.toFixed(0)} ${e.unit.name} `:"??? "),1),(0,a.Uk)((0,D.zw)(e.name),1)],8,_e)])))),128))])):((0,a.wg)(),(0,a.iD)("div",ke,[(0,a._)("div",qe,[(0,a.Wm)(s,{name:"shopping_cart",size:"md",class:"q-mr-md"}),We])]))]),(0,a.Wm)(c)])),_:1},512)}const{getFoodFromDay:ve}=o(2221),{getSelectedDay:Se}=o(1897),{dayToStorageDate:be}=o(7691),Ce=(0,a.aZ)({name:"DialogShoppingList",setup(){return{foodList:(0,m.iH)([]),list:(0,m.iH)(null)}},methods:{open(e){this.$refs.shoppingListDialog.open(),this.loadItems(e)},close(){this.$refs.shoppingListDialog.close()},createShoppingList(e){let t=[];for(let o of e)if(o.ingredients)for(let e of o.ingredients){let a=t.find((t=>t.id===e.id));a?a.quantity=a.quantity+e.quantity*o.quantity:(e.quantity=e.quantity*o.quantity,e.ticked=!1,t.push(e))}else{let e=t.find((e=>e.id===o.id));e?e.quantity=e.quantity+o.quantity:(o.ticked=!1,t.push(o))}return t},async loadItems(e){if(this.list=e,this.foodList=[],"plan"===e){let e=[];for(let t=0;t<=6;t++){let o=await ve({storageDay:`day-${t}`});e=[...e,...o]}this.foodList=this.createShoppingList(e)}else if("day"===e){let e=be(Se()),t=await ve({storageDay:e});this.foodList=this.createShoppingList(t)}}}});var Fe=o(5735),xe=o(4554),Qe=o(5869);const Te=(0,b.Z)(Ce,[["render",Ze]]),Le=Te;T()(Ce,"components",{QCheckbox:Fe.Z,QIcon:xe.Z,QSeparator:Qe.Z});const{getFoodFromDay:$e,setClipboard:Pe,getClipboard:He,clearDay:Ie,addFoodToDay:Ve}=o(2221),{dayToStorageDate:ze}=o(7691),Ue=(0,a.aZ)({name:"Home",components:{Diary:O,Plan:he,ShoppingList:Le},setup(){return{list:(0,m.iH)("plan"),planType:(0,m.iH)(""),planTypeModel:(0,m.iH)(null),loading:(0,m.iH)(!1)}},mounted(){this.loadPlanType()},methods:{copyPlan(){let e=ze(v().getSelectedDay());this.loading=!0,$e({storageDay:e}).then((e=>{e.length<1?this.$q.notify({type:"warning",message:"No food added to this day yet."}):(Pe(e),this.$q.notify({type:"good",message:"Copied!"}))})).catch((e=>{this.$q.notify({type:"bad",message:"Failed to load food!"})})).finally((()=>this.loading=!1))},pastePlan(){this.loading=!0,He().then((e=>{if(e.length<1)return void this.$q.notify({type:"warning",message:"Clipboard is empty."});let t=ze(v().getSelectedDay());Ie({storageDay:t});for(let o of e)Ve({storageDay:t,food:o,quantity:o.quantity});this.$refs[this.planType].updateFoodlist(),this.$q.notify({type:"good",message:"Pasted!"})})).catch((e=>{this.$q.notify({type:"bad",message:"Failed to load clipboard!"})})).finally((()=>{this.loading=!1}))},loadPlanType(){this.planType=v().getPlanType(),this.planTypeModel="Diary"!==this.planType},openShoppingList(e){this.$refs.shoppingList.open(e)}},watch:{planTypeModel(e){this.planType=e?"Plan":"Diary",v().setPlanType(this.planType)}}});var Me=o(6335);const je=(0,b.Z)(Ue,[["render",u]]),Be=je;T()(Ue,"components",{QBtn:C.Z,QMenu:Me.Z,QList:le.Z,QItem:ie.Z,QItemSection:ne.Z,QIcon:xe.Z,QSeparator:Qe.Z,QInnerLoading:B.Z,QSpinnerTail:A.Z})}}]);